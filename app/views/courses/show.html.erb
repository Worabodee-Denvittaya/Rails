<p id="notice"><%= notice %></p>

<p>
  <strong>Title:</strong>
  <%= @course.title %>
</p>

<p>
  <strong>Description:</strong>
  <%= @course.description %>
</p>

<p>
  <strong>Owner:</strong>
  <%= @course.user_id %>
</p>

<% if @course.subscriptions.exists?(user_id: current_user.id) %>
  <%# Show all the groups in this course%>
  <% @groups = @course.groups %>
  <% if  @groups.size == 1 %>
    <strong>There is currently no group</strong>
  <% else %>
    <h1>Groups</h1>

    <table class="table">
      <thead class="thead-dark">
        <tr>
          <th>Name</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @groups.each do |group| %>
          <% if group != @course.groups.first %>
            <tr>
              <td><%= group.name %></td>
              <td><%= link_to 'Show', group %></td>
              <td><%= link_to 'Edit', edit_group_path(group) %></td>
              <td><%= link_to 'Destroy', group, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

    <br>
  <% end %>
<% else %>
  <%= form_with(model: [ @course, @course.subscriptions.build ], local: true) do |form| %>
    <%= form.submit 'Subscribe' %>
  <% end %>
  
<% end %>

<%# if current user owns the course%>
<% if @course.user_id == current_user.id %>
  <%= form_with(model: [ @course, @course.groups.build ], local: true) do |form| %>
    <%= form.submit 'Create a new group' %>
  <% end %>
<% end %>

<%= link_to 'Edit', edit_course_path(@course) %> |
<%= link_to 'Back', courses_path %>
